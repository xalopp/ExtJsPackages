<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='Mayflower-grid-feature-FilterFormController'>/**
</span> * Controller for {@link Mayflower.grid.feature.FilterForm FilterForm}
 */
Ext.define('Mayflower.grid.feature.FilterFormController', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.filterform',

<span id='Mayflower-grid-feature-FilterFormController-method-onApplyFilters'>    /**
</span>     * Apply filter form values to grid
     */
    onApplyFilters: function () {
        var view = this.getView(),
            store = view.up().getStore(),
            formValues = view.getForm().getValues(),
            filters = this.buildFilter(formValues);

        store.clearFilter();
        store.setFilters(filters);
    },

<span id='Mayflower-grid-feature-FilterFormController-method-onResetFilters'>    /**
</span>     * Reset filter form values
     */
    onResetFilters: function () {
        this.getView().getForm().reset();
    },

<span id='Mayflower-grid-feature-FilterFormController-method-buildFilter'>    /**
</span>     * Build filters for given form values, as consumed by {@see Ext.store.Store#setFilters Store setFilters} function.
     *
     * @param {Object} formValues
     * @returns {Function[]} array of filter functions
     *
     * @private
     */
    buildFilter:  function (formValues) {
        var filters = [];

        Ext.iterate(formValues, function (key, value) {
            if (!Ext.isEmpty(value)) {
                filters.push(function (item) {
                    var itemValue = item.get(key);

                    if (Ext.isString(itemValue)) {
                        return Ext.String.startsWith(itemValue, value);
                    }
                    return itemValue === value;
                });
            }
        });

        return filters;
    }
});
</pre>
</body>
</html>
